<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title data-i18n="page-title">Malarg√ºe | Viaje Familiar a Argentina</title>
  <link rel="stylesheet" href="estilos.css">
  <style>
    /* Estilos generales del cuerpo y barra superior */
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
      margin: 20px;
      transition: direction 0.3s;
    }
    #language-selector {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background-color: rgba(255,255,255,0.8);
      padding: 5px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: flex; /* Para alinear los botones de idioma y moneda */
      align-items: center;
      gap: 10px; /* Espacio entre elementos */
    }
    .language-btn, .currency-btn { /* Clase unificada para botones de control */
      font-weight: bold;
      padding: 8px 12px;
      margin: 0 2px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background-color: #f0f0f0;
    }
    .language-btn.active, .currency-btn.active {
      background: #e6eaff;
      border-color: #6d7fc9;
      font-weight: bold;
    }
    .back-link {
      margin-left: 20px;
      text-decoration: none;
      font-weight: bold;
      color: #007BFF;
    }
    /* Estilos para la foto de la ciudad */
    .ciudad-foto {
      width: 100%;
      max-width: 700px;
      height: auto;
      display: block;
      margin: 30px auto 20px auto;
      border-radius: 14px;
      box-shadow: 0 3px 16px rgba(0,0,0,0.15);
    }
    .foto-caption {
      text-align: center;
      color: #555;
      font-size: 1em;
      margin-bottom: 30px;
    }
    h1, h2, h3 { /* Agregado h3 para subsecciones */
      color: #0F4761;
    }
    ul {
      margin-bottom: 20px;
      padding-left: 25px; /* Ajuste para listas */
    }
    ul li {
      margin-bottom: 5px;
    }
    iframe {
      border: 1px solid black;
      width: 100%; /* Asegura que el mapa sea responsive */
      max-width: 700px; /* Limita el ancho m√°ximo del mapa */
      display: block;
      margin: 20px auto; /* Centra el mapa */
    }
    /* Estilos para tablas a√±adidas */
    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 700px; /* Limita el ancho m√°ximo de las tablas */
      margin: 20px auto;
      background: #f7fbff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #b3c7e6;
      padding: 10px 15px;
      text-align: left;
      font-size: 16px;
    }
    th {
      background: #e6f0fa;
      font-weight: bold;
    }
    .rtl {
      direction: rtl !important;
      text-align: right !important;
    }
    .rtl ul {
      padding-right: 25px;
      padding-left: 0;
    }

    /* Estilos para las secciones de IA */
    .ai-section {
      background: #e6f0fa;
      padding: 20px;
      border-radius: 8px;
      margin: 30px auto;
      max-width: 700px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .ai-section h2 {
      color: #2176d2;
      margin-top: 0;
    }
    .ai-button {
      background-color: #4CAF50; /* Green */
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s ease;
      display: block;
      margin: 15px auto;
      max-width: 300px;
    }
    .ai-button:hover {
      background-color: #45a049;
    }
    .ai-button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    .ai-response {
      margin-top: 20px;
      padding: 15px;
      background-color: #ffffff;
      border: 1px solid #d0e0f0;
      border-radius: 5px;
      white-space: pre-wrap;
      font-size: 15px;
      line-height: 1.6;
      min-height: 50px;
    }
    .ai-loading {
      text-align: center;
      font-style: italic;
      color: #666;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div id="language-selector">
    <span data-i18n="idioma">Idioma:</span>
    <button onclick="translatePage('es')" class="language-btn" id="btn-es">Espa√±ol</button>
    <button onclick="translatePage('he')" class="language-btn" id="btn-he">◊¢◊ë◊®◊ô◊™</button>
    <span data-i18n="moneda">Moneda:</span>
    <button id="btn-ars" onclick="cambiarMoneda('ARS')" class="currency-btn">ARS</button>
    <button id="btn-usd" onclick="cambiarMoneda('USD')" class="currency-btn">USD</button>
    <button id="btn-ils" onclick="cambiarMoneda('ILS')" class="currency-btn">ILS</button>
    <a href="../index.html" class="back-link" id="back-link" data-i18n="back-link">‚¨Ö Volver al itinerario</a>
  </div>

  <img src="../docs/imagenes/malargue/malargue.jpg"
       alt="Paisaje volc√°nico de Malarg√ºe"
       class="ciudad-foto" id="city-photo" onerror="this.src='https://placehold.co/700x400/cccccc/333333?text=Imagen+Malarg%C3%BCe'">
  <div class="foto-caption" id="foto-caption" data-i18n="foto-caption">Paisaje volc√°nico de Malarg√ºe</div>

  <h1 id="city-title" data-i18n="city-title">Malarg√ºe</h1>
  <p id="welcome-text" data-i18n="welcome-text">Malarg√ºe es una ciudad en el sur de Mendoza, conocida por sus paisajes volc√°nicos, formaciones geol√≥gicas √∫nicas y aventuras en la naturaleza. Es la puerta de entrada a atractivos como la Caverna de las Brujas y la Laguna de la Ni√±a Encantada.</p>

  <h2 data-i18n="dates-duration-title">Fechas y duraci√≥n</h2>
  <ul>
    <li data-i18n="stay-duration">**Estad√≠a**: 13/10 al 16/10 (4 d√≠as)</li>
    <li data-i18n="how-to-arrive">**C√≥mo llegar**: Bus desde Mendoza / Auto de alquiler</li>
  </ul>

  <h2 id="main-attractions-title" data-i18n="main-attractions-title">Lugares imperdibles</h2>
  <ul id="main-attractions-list">
    <li><a href="https://www.malargue.tur.ar/caverna-de-las-brujas/" target="_blank" id="attraction-0" data-i18n="attraction-0">Caverna de las Brujas</a></li>
    <li><a href="https://www.malargue.tur.ar/la-payunia/" target="_blank" id="attraction-1" data-i18n="attraction-1">La Payunia</a></li>
    <li><a href="https://www.malargue.tur.ar/laguna-nina-encantada/" target="_blank" id="attraction-2" data-i18n="attraction-2">Laguna de la Ni√±a Encantada</a></li>
    <li><a href="https://www.laslenas.com/" target="_blank" id="attraction-3" data-i18n="attraction-3">Valle de Las Le√±as</a></li>
    <li><a href="https://www.malargue.tur.ar/dino-park/" target="_blank" id="attraction-4" data-i18n="attraction-4">Dino Park (Parque Huellas de Dinosaurios)</a></li>
    <li><a href="https://www.malargue.tur.ar/planetario/" target="_blank" id="attraction-5" data-i18n="attraction-5">Planetario Malarg√ºe</a></li>
  </ul>

  <h2 data-i18n="recommended-activities-title">Actividades recomendadas</h2>
  <ul>
    <li data-i18n="rec-activity-0">Excursiones guiadas a la Caverna de las Brujas.</li>
    <li data-i18n="rec-activity-1">Safari fotogr√°fico en La Payunia (si las edades y el inter√©s lo permiten).</li>
    <li data-i18n="rec-activity-2">Trekking suave o paseos en bicicleta por el Valle de Las Le√±as (fuera de temporada de nieve).</li>
    <li data-i18n="rec-activity-3">Visita al Observatorio Pierre Auger (con reserva).</li>
    <li data-i18n="rec-activity-4">Rafting o cabalgatas en los alrededores.</li>
    <li data-i18n="rec-activity-5">Exploraci√≥n de la Laguna de la Ni√±a Encantada y sus formaciones rocosas.</li>
  </ul>

  <h2 data-i18n="gastronomy-title">Gastronom√≠a destacada</h2>
  <p data-i18n="gastronomy-intro">La gastronom√≠a en Malarg√ºe se enfoca en platos patag√≥nicos, carnes a la parrilla, chivito a la llama (plato t√≠pico de la zona) y productos regionales. Las opciones para dietas especiales pueden ser m√°s limitadas, por lo que se recomienda preguntar.</p>
  <h3 data-i18n="restaurants-title">Restaurantes recomendados</h3>
  <table>
    <thead>
      <tr>
        <th data-i18n="table-restaurant">Restaurante</th>
        <th data-i18n="table-type">Tipo</th>
        <th data-i18n="table-gluten-free">Sin Gluten</th>
        <th data-i18n="table-sugar-free">Sin Az√∫car</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a href="https://www.tripadvisor.com.ar/Restaurant_Review-g303403-d10103700-Reviews-La_Posta_de_Jamon-Malargue_Province_of_Mendoza_Cuyo.html" target="_blank">La Posta de Jam√≥n</a></td>
        <td data-i18n="restaurant-type-0">Parrilla / Chivito a la llama</td>
        <td data-i18n="yes-symbol">‚úîÔ∏è</td>
        <td data-i18n="no-symbol">‚ùå</td>
      </tr>
      <tr>
        <td><a href="https://www.tripadvisor.com.ar/Restaurant_Review-g303403-d10103700-Reviews-El_Viejo_Retiro-Malargue_Province_of_Mendoza_Cuyo.html" target="_blank">El Viejo Retiro</a></td>
        <td data-i18n="restaurant-type-1">Comida casera / Regional</td>
        <td data-i18n="yes-symbol">‚úîÔ∏è</td>
        <td data-i18n="yes-symbol">‚úîÔ∏è</td>
      </tr>
      <tr>
        <td><a href="https://www.tripadvisor.com.ar/Restaurant_Review-g303403-d10103700-Reviews-Pizzeria_La_Avenida-Malargue_Province_of_Mendoza_Cuyo.html" target="_blank">Pizzer√≠a La Avenida</a></td>
        <td data-i18n="restaurant-type-2">Pizzer√≠a tradicional</td>
        <td data-i18n="no-symbol">‚ùå</td>
        <td data-i18n="no-symbol">‚ùå</td>
      </tr>
    </tbody>
  </table>
  <h3 data-i18n="cafes-title">Confiter√≠as y caf√©s</h3>
  <table>
    <thead>
      <tr>
        <th data-i18n="table-cafe">Confiter√≠a</th>
        <th data-i18n="table-type">Tipo</th>
        <th data-i18n="table-gluten-free">Sin Gluten</th>
        <th data-i18n="table-sugar-free">Sin Az√∫car</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td data-i18n="cafe-type-0">(Opciones limitadas)</td>
        <td data-i18n="cafe-type-1">Caf√©s locales / panader√≠as</td>
        <td data-i18n="no-symbol">‚ùå</td>
        <td data-i18n="no-symbol">‚ùå</td>
      </tr>
      <tr>
        <td data-i18n="cafe-type-2">Supermercados</td>
        <td data-i18n="cafe-type-3">Para abastecerse</td>
        <td data-i18n="yes-symbol">‚úîÔ∏è</td>
        <td data-i18n="yes-symbol">‚úîÔ∏è</td>
      </tr>
    </tbody>
  </table>

  <div class="ai-section">
    <h2 data-i18n="ai-menu-title">Generador de Men√∫ Saludable ‚ú®</h2>
    <p data-i18n="ai-menu-description">Obt√©n sugerencias de men√∫ para un d√≠a completo (desayuno, almuerzo, cena) adaptadas para dietas bajas en carbohidratos, aptas para diab√©ticos y, si es posible, sin gluten, inspiradas en la gastronom√≠a de Malarg√ºe.</p>
    <button class="ai-button" id="generate-menu-btn" data-i18n="generate-menu-button">Generar Men√∫</button>
    <div class="ai-loading" id="ai-menu-loading-indicator" style="display:none;" data-i18n="ai-loading">Generando men√∫...</div>
    <div class="ai-response" id="ai-menu-response"></div>
  </div>

  <div class="ai-section">
    <h2 data-i18n="ai-accommodation-title">Sugerencias de Alojamiento con IA üè®</h2>
    <p data-i18n="ai-accommodation-description">Obt√©n recomendaciones de alojamiento en Malarg√ºe, considerando opciones familiares, seguras y bien ubicadas.</p>
    <button class="ai-button" id="generate-accommodation-btn" data-i18n="generate-accommodation-button">Generar Sugerencias</button>
    <div class="ai-loading" id="ai-accommodation-loading-indicator" style="display:none;" data-i18n="ai-loading">Generando sugerencias...</div>
    <div class="ai-response" id="ai-accommodation-response"></div>
  </div>

  <div class="ai-section">
    <h2 data-i18n="ai-family-tips-title">Consejos Adicionales para Familias con IA üë®‚Äçüë©‚Äçüëß‚Äçüë¶</h2>
    <p data-i18n="ai-family-tips-description">Recibe consejos personalizados para disfrutar Malarg√ºe en familia, incluyendo actividades, seguridad y log√≠stica.</p>
    <button class="ai-button" id="generate-family-tips-btn" data-i18n="generate-family-tips-button">Generar Consejos</button>
    <div class="ai-loading" id="ai-family-tips-loading-indicator" style="display:none;" data-i18n="ai-loading">Generando consejos...</div>
    <div class="ai-response" id="ai-family-tips-response"></div>
  </div>

  <div class="ai-section">
    <h2 data-i18n="ai-budget-title">An√°lisis de Presupuesto con IA üí∞</h2>
    <p data-i18n="ai-budget-description">Obt√©n un an√°lisis y desglose del presupuesto orientativo para tu estad√≠a en Malarg√ºe, con posibles optimizaciones.</p>
    <button class="ai-button" id="generate-budget-btn" data-i18n="generate-budget-button">Analizar Presupuesto</button>
    <div class="ai-loading" id="ai-budget-loading-indicator" style="display:none;" data-i18n="ai-loading">Analizando presupuesto...</div>
    <div class="ai-response" id="ai-budget-response"></div>
  </div>

  <h2 data-i18n="accommodation-title">Alojamiento (ejemplos)</h2>
  <ul>
    <li data-i18n="accommodation-0">Hotel Malarg√ºe</li>
    <li data-i18n="accommodation-1">Complejo Los Molles (cerca de Las Le√±as)</li>
    <li data-i18n="accommodation-2">Caba√±as y hospedajes rurales.</li>
    <li data-i18n="accommodation-3">Airbnb en el centro de Malarg√ºe.</li>
  </ul>

  <h2 data-i18n="coordinates-title">Coordenadas aproximadas</h2>
  <p data-i18n="coordinates-text">35¬∞ 28' S 69¬∞ 35' O</p>

  <h2 data-i18n="events-agenda-title">Agenda de eventos</h2>
  <ul>
    <li data-i18n="event-0">**(Consultar agenda local)**: Fiesta Nacional del Chivo (Enero).</li>
    <li data-i18n="event-1">**(Consultar agenda local)**: Eventos relacionados con astronom√≠a o geolog√≠a.</li>
    <li><a href="../docs/agenda/ariflier1970@gmail.com.ical.zip" target="_blank" data-i18n="download-agenda">Descargar agenda completa en formato iCal (.zip)</a></li>
  </ul>

  <h2 data-i18n="family-tips-title">Consejos para familias</h2>
  <ul>
    <li data-i18n="family-tip-0">Para explorar los atractivos naturales, es casi indispensable contar con un veh√≠culo propio o contratar excursiones organizadas.</li>
    <li data-i18n="family-tip-1">La Caverna de las Brujas puede ser un poco exigente f√≠sicamente para ni√±os muy peque√±os o personas con movilidad reducida.</li>
    <li data-i18n="family-tip-2">Lleven abundante agua y ropa adecuada para cambios bruscos de temperatura, especialmente si visitan √°reas de alta monta√±a o desierto.</li>
    <li data-i18n="family-tip-3">La se√±al de celular puede ser limitada fuera de la ciudad.</li>
    <li data-i18n="family-tip-4">Respeten las indicaciones de los gu√≠as en las reservas naturales.</li>
  </ul>

  <h2 data-i18n="budget-title">Presupuesto orientativo</h2>
  <table>
    <thead>
      <tr>
        <th data-i18n="budget-concept">Concepto</th>
        <th data-i18n="budget-price">Precio estimado (USD)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td data-i18n="budget-concept-0">Alojamiento (noche, familia)</td>
        <td data-i18n="budget-price-0">40‚Äì100</td>
      </tr>
      <tr>
        <td data-i18n="budget-concept-1">Comida (por d√≠a, familia)</td>
        <td data-i18n="budget-price-1">25‚Äì60</td>
      </tr>
      <tr>
        <td data-i18n="budget-concept-2">Transporte local (por d√≠a)</td>
        <td data-i18n="budget-price-2">5‚Äì15 (excl. alquiler auto)</td>
      </tr>
      <tr>
        <td data-i18n="budget-concept-3">Actividades y tours (por d√≠a)</td>
        <td data-i18n="budget-price-3">20‚Äì60 (excl. Payunia)</td>
      </tr>
      <tr>
        <td data-i18n="budget-concept-4">Entradas museos/atracciones</td>
        <td data-i18n="budget-price-4">0‚Äì15</td>
      </tr>
    </tbody>
  </table>

  <h2 data-i18n="cultural-tips-title">Tips culturales</h2>
  <ul>
    <li data-i18n="cultural-tip-0">Malarg√ºe es una regi√≥n m√°s rural y con una fuerte identidad de campo.</li>
    <li data-i18n="cultural-tip-1">La vida nocturna es limitada; el foco est√° en la naturaleza y el descanso.</li>
    <li data-i18n="cultural-tip-2">El chivito a la llama es una tradici√≥n culinaria muy arraigada y un imperdible local.</li>
    <li data-i18n="cultural-tip-3">La amabilidad y la hospitalidad de su gente son caracter√≠sticas destacadas.</li>
  </ul>

  <h2 id="map-title" data-i18n="map-title">Mapa de Malarg√ºe</h2>
  <iframe src="https://www.openstreetmap.org/export/embed.html?bbox=-69.75%2C-35.6%2C-69.45%2C-35.3&amp;layer=mapnik" width="100%" height="350"></iframe>
  <br><small><a href="https://www.openstreetmap.org/#map=12/-35.478/-69.585" target="_blank" id="see-bigger-map" data-i18n="see-bigger-map">Ver mapa m√°s grande</a></small>

  <script>
    // Diccionario de traducciones espa√±ol ‚Üî hebreo
    const translations = {
      es: {
        "page-title": "Malarg√ºe | Viaje Familiar a Argentina",
        "idioma": "Idioma:",
        "moneda": "Moneda:",
        "city-title": "Malarg√ºe",
        "welcome-text": "Malarg√ºe es una ciudad en el sur de Mendoza, conocida por sus paisajes volc√°nicos, formaciones geol√≥gicas √∫nicas y aventuras en la naturaleza. Es la puerta de entrada a atractivos como la Caverna de las Brujas y la Laguna de la Ni√±a Encantada.",
        "foto-caption": "Paisaje volc√°nico de Malarg√ºe",
        "dates-duration-title": "Fechas y duraci√≥n",
        "stay-duration": "**Estad√≠a**: 13/10 al 16/10 (4 d√≠as)",
        "how-to-arrive": "**C√≥mo llegar**: Bus desde Mendoza / Auto de alquiler",
        "main-attractions-title": "Lugares imperdibles",
        "attraction-0": "Caverna de las Brujas",
        "attraction-1": "La Payunia",
        "attraction-2": "Laguna de la Ni√±a Encantada",
        "attraction-3": "Valle de Las Le√±as",
        "attraction-4": "Dino Park (Parque Huellas de Dinosaurios)",
        "attraction-5": "Planetario Malarg√ºe",
        "recommended-activities-title": "Actividades recomendadas",
        "rec-activity-0": "Excursiones guiadas a la Caverna de las Brujas.",
        "rec-activity-1": "Safari fotogr√°fico en La Payunia (si las edades y el inter√©s lo permiten).",
        "rec-activity-2": "Trekking suave o paseos en bicicleta por el Valle de Las Le√±as (fuera de temporada de nieve).",
        "rec-activity-3": "Visita al Observatorio Pierre Auger (con reserva).",
        "rec-activity-4": "Rafting o cabalgatas en los alrededores.",
        "rec-activity-5": "Exploraci√≥n de la Laguna de la Ni√±a Encantada y sus formaciones rocosas.",
        "gastronomy-title": "Gastronom√≠a destacada",
        "gastronomy-intro": "La gastronom√≠a en Malarg√ºe se enfoca en platos patag√≥nicos, carnes a la parrilla, chivito a la llama (plato t√≠pico de la zona) y productos regionales. Las opciones para dietas especiales pueden ser m√°s limitadas, por lo que se recomienda preguntar.",
        "restaurants-title": "Restaurantes recomendados",
        "table-restaurant": "Restaurante",
        "table-type": "Tipo",
        "table-gluten-free": "Sin Gluten",
        "table-sugar-free": "Sin Az√∫car",
        "restaurant-type-0": "Parrilla / Chivito a la llama",
        "restaurant-type-1": "Comida casera / Regional",
        "restaurant-type-2": "Pizzer√≠a tradicional",
        "cafes-title": "Confiter√≠as y caf√©s",
        "table-cafe": "Confiter√≠a",
        "cafe-type-0": "(Opciones limitadas)",
        "cafe-type-1": "Caf√©s locales / panader√≠as",
        "cafe-type-2": "Supermercados",
        "cafe-type-3": "Para abastecerse",
        "yes-symbol": "‚úîÔ∏è",
        "no-symbol": "‚ùå",
        "ai-menu-title": "Generador de Men√∫ Saludable ‚ú®",
        "ai-menu-description": "Obt√©n sugerencias de men√∫ para un d√≠a completo (desayuno, almuerzo, cena) adaptadas para dietas bajas en carbohidratos, aptas para diab√©ticos y, si es posible, sin gluten, inspiradas en la gastronom√≠a de Malarg√ºe.",
        "generate-menu-button": "Generar Men√∫",
        "ai-loading": "Generando men√∫...",
        "ai-error": "Error al generar el men√∫. Por favor, int√©ntalo de nuevo m√°s tarde.",
        "ai-menu-prompt": "Genera un plan de men√∫ de un d√≠a (desayuno, almuerzo, cena) para una familia que visita Malarg√ºe, Argentina. Las opciones deben ser aptas para diab√©ticos, bajas en carbohidratos y, si es posible, sin gluten. Incluye ejemplos de platos t√≠picos de Malarg√ºe (chivito, etc.) adaptados a estas restricciones diet√©ticas. Formatea la respuesta en p√°rrafos claros para cada comida.",
        "ai-accommodation-title": "Sugerencias de Alojamiento con IA üè®",
        "ai-accommodation-description": "Obt√©n recomendaciones de alojamiento en Malarg√ºe, considerando opciones familiares, seguras y bien ubicadas.",
        "generate-accommodation-button": "Generar Sugerencias",
        "ai-accommodation-prompt": "Genera 3-5 sugerencias de alojamiento en Malarg√ºe, Argentina, ideales para una familia con 2 hijos. Considera opciones seguras, bien ubicadas y con servicios adecuados para familias. Incluye diferentes tipos de alojamiento como hoteles, complejos tur√≠sticos o caba√±as. Formatea la respuesta con vi√±etas.",
        "ai-family-tips-title": "Consejos Adicionales para Familias con IA üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
        "ai-family-tips-description": "Recibe consejos personalizados para disfrutar Malarg√ºe en familia, incluyendo actividades, seguridad y log√≠stica.",
        "generate-family-tips-button": "Generar Consejos",
        "ai-family-tips-prompt": "Proporciona 5 consejos pr√°cticos y personalizados para una familia con ni√±os que visita Malarg√ºe, Argentina. Los consejos deben cubrir aspectos como actividades para ni√±os, seguridad en la ciudad y en la naturaleza, opciones de transporte familiar, y c√≥mo aprovechar al m√°ximo la estad√≠a. Formatea la respuesta con vi√±etas.",
        "ai-budget-title": "An√°lisis de Presupuesto con IA üí∞",
        "ai-budget-description": "Obt√©n un an√°lisis y desglose del presupuesto orientativo para tu estad√≠a en Malarg√ºe, con posibles optimizaciones.",
        "generate-budget-button": "Analizar Presupuesto",
        "ai-budget-prompt": "Analiza el siguiente presupuesto orientativo para una familia en Malarg√ºe (USD): Alojamiento (noche): 40-100, Comida (d√≠a): 25-60, Transporte local (d√≠a): 5-15 (excl. alquiler auto), Actividades (d√≠a): 20-60 (excl. Payunia), Entradas: 0-15. Proporciona un desglose estimado por d√≠a y por categor√≠a, y sugiere 2-3 formas de optimizar o ahorrar en este presupuesto sin sacrificar la experiencia familiar. Formatea la respuesta en p√°rrafos.",
        "accommodation-title": "Alojamiento (ejemplos)",
        "accommodation-0": "Hotel Malarg√ºe",
        "accommodation-1": "Complejo Los Molles (cerca de Las Le√±as)",
        "accommodation-2": "Caba√±as y hospedajes rurales.",
        "accommodation-3": "Airbnb en el centro de Malarg√ºe.",
        "coordinates-title": "Coordenadas aproximadas",
        "coordinates-text": "35¬∞ 28' S 69¬∞ 35' O",
        "events-agenda-title": "Agenda de eventos",
        "event-0": "**(Consultar agenda local)**: Fiesta Nacional del Chivo (Enero).",
        "event-1": "**(Consultar agenda local)**: Eventos relacionados con astronom√≠a o geolog√≠a.",
        "download-agenda": "Descargar agenda completa en formato iCal (.zip)",
        "family-tips-title": "Consejos para familias",
        "family-tip-0": "Para explorar los atractivos naturales, es casi indispensable contar con un veh√≠culo propio o contratar excursiones organizadas.",
        "family-tip-1": "La Caverna de las Brujas puede ser un poco exigente f√≠sicamente para ni√±os muy peque√±os o personas con movilidad reducida.",
        "family-tip-2": "Lleven abundante agua y ropa adecuada para cambios bruscos de temperatura, especialmente si visitan √°reas de alta monta√±a o desierto.",
        "family-tip-3": "La se√±al de celular puede ser limitada fuera de la ciudad.",
        "family-tip-4": "Respeten las indicaciones de los gu√≠as en las reservas naturales.",
        "budget-title": "Presupuesto orientativo",
        "budget-concept": "Concepto",
        "budget-price": "Precio estimado (USD)",
        "budget-concept-0": "Alojamiento (noche, familia)",
        "budget-price-0": "40‚Äì100",
        "budget-concept-1": "Comida (por d√≠a, familia)",
        "budget-price-1": "25‚Äì60",
        "budget-concept-2": "Transporte local (por d√≠a)",
        "budget-price-2": "5‚Äì15 (excl. alquiler auto)",
        "budget-concept-3": "Actividades y tours (por d√≠a)",
        "budget-price-3": "20‚Äì60 (excl. Payunia)",
        "budget-concept-4": "Entradas museos/atracciones",
        "budget-price-4": "0‚Äì15",
        "cultural-tips-title": "Tips culturales",
        "cultural-tip-0": "◊û◊ú◊ê◊®◊í◊ï◊ê◊î ◊î◊ï◊ê ◊ê◊ñ◊ï◊® ◊õ◊§◊®◊ô ◊ô◊ï◊™◊® ◊¢◊ù ◊ñ◊î◊ï◊™ ◊©◊ì◊î ◊ó◊ñ◊ß◊î.",
        "cultural-tip-1": "◊ó◊ô◊ô ◊î◊ú◊ô◊ú◊î ◊û◊ï◊í◊ë◊ú◊ô◊ù; ◊î◊ì◊í◊© ◊î◊ï◊ê ◊¢◊ú ◊î◊ò◊ë◊¢ ◊ï◊î◊û◊†◊ï◊ó◊î.",
        "cultural-tip-2": "◊¶'◊ô◊ë◊ô◊ò◊ï ◊ê-◊ú◊î-◊ô◊ê◊û◊î ◊î◊ï◊ê ◊û◊°◊ï◊®◊™ ◊ß◊ï◊ú◊ô◊†◊®◊ô◊™ ◊û◊ï◊©◊®◊©◊™ ◊û◊ê◊ï◊ì ◊ï◊§◊®◊ô◊ò ◊ó◊ï◊ë◊î ◊û◊ß◊ï◊û◊ô.",
        "cultural-tip-3": "◊ê◊ì◊ô◊ë◊ï◊™◊ù ◊ï◊ê◊ô◊®◊ï◊ó◊ù ◊©◊ú ◊î◊û◊ß◊ï◊û◊ô◊ô◊ù ◊ë◊ï◊ú◊ò◊ô◊ù.",
        "map-title": "◊û◊§◊™ ◊û◊ú◊ê◊®◊í◊ï◊ê◊î",
        "see-bigger-map": "◊ú◊¶◊§◊ô◊ô◊î ◊ë◊û◊§◊î ◊í◊ì◊ï◊ú◊î ◊ô◊ï◊™◊®",
        "back-link": "‚¨Ö ◊ó◊ñ◊®◊î ◊ú◊û◊§◊™ ◊î◊û◊°◊ú◊ï◊ú"
      }
    };

    // Tasas de cambio (se actualizan al cargar la p√°gina)
    let tasas = {
      ARS: 1,
      USD: 1000, // Valor de ejemplo, se actualizar√°
      ILS: 110   // Valor de ejemplo, se actualizar√°
    };
    // S√≠mbolos de moneda
    const simbolos = {
      ARS: "$",
      USD: "US$",
      ILS: "‚Ç™"
    };

    let idiomaActual = 'es'; // Idioma predeterminado
    let monedaActual = 'ARS'; // Moneda predeterminada

    // Funci√≥n para obtener tasas de cambio reales desde ExchangeRate-API
    function actualizarTasas(callback) {
      fetch('https://open.er-api.com/v6/latest/USD')
        .then(response => response.json())
        .then(data => {
          if (data && data.result === "success") {
            tasas.ARS = data.rates.ARS;
            tasas.USD = 1;
            tasas.ILS = data.rates.ILS;
          }
          if (typeof callback === "function") callback();
        })
        .catch(() => {
          // Si falla, sigue con los valores por defecto
          if (typeof callback === "function") callback();
        });
    }

    function translatePage(language) {
      idiomaActual = language; // Actualiza la variable global idiomaActual
      document.body.dir = (language === 'he') ? 'rtl' : 'ltr';
      document.title = translations[language]["page-title"];

      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[language][key]) { // Asegurarse de que la clave exista
          if (key.includes('event-') || key.includes('stay-duration') || key.includes('how-to-arrive')) {
            el.innerHTML = translations[language][key];
          } else {
            el.textContent = translations[language][key];
          }
        }
      });
      // Actualiza el estado activo de los botones de idioma
      document.getElementById('btn-es').classList.toggle('active', language === 'es');
      document.getElementById('btn-he').classList.toggle('active', language === 'he');
      // Guarda la preferencia de idioma en localStorage
      localStorage.setItem('idiomaPreferido', language);
    }

    function cambiarMoneda(moneda) {
      monedaActual = moneda; // Actualiza la variable global monedaActual
      document.getElementById('btn-ars').classList.toggle('active', moneda === 'ARS');
      document.getElementById('btn-usd').classList.toggle('active', moneda === 'USD');
      document.getElementById('btn-ils').classList.toggle('active', moneda === 'ILS');
      // Guarda la preferencia de moneda en localStorage
      localStorage.setItem('monedaPreferida', moneda);
      // No hay tablas de precios din√°micas en esta p√°gina de ciudad, pero si se agregaran, se llamar√≠an aqu√≠.
    }

    // Funci√≥n gen√©rica para llamar a la API de Gemini
    async function callGeminiAPI(promptKey, responseDivId, buttonId, loadingIndicatorId) {
      const button = document.getElementById(buttonId);
      const loadingIndicator = document.getElementById(loadingIndicatorId);
      const responseDiv = document.getElementById(responseDivId);

      button.disabled = true;
      loadingIndicator.style.display = 'block';
      responseDiv.textContent = ''; // Limpiar respuesta anterior

      const currentLanguage = localStorage.getItem('idiomaPreferido') || 'es';
      // Asegurarse de que el prompt se obtiene correctamente del diccionario
      const promptText = translations[currentLanguage][promptKey];

      if (!promptText) {
        responseDiv.textContent = translations[currentLanguage]["ai-error"] + " (Prompt no encontrado)";
        console.error(`Error: Prompt con clave '${promptKey}' no encontrado para el idioma '${currentLanguage}'.`);
        button.disabled = false;
        loadingIndicator.style.display = 'none';
        return;
      }

      let chatHistory = [];
      chatHistory.push({ role: "user", parts: [{ text: promptText }] });

      const payload = {
        contents: chatHistory,
        generationConfig: {
            responseMimeType: "text/plain"
        }
      };

      const apiKey = ""; // La clave API se proporcionar√° en tiempo de ejecuci√≥n por el entorno Canvas
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

      try {
        const response = await fetch(apiUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        const result = await response.json();

        if (result.candidates && result.candidates.length > 0 &&
            result.candidates[0].content && result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0) {
          const text = result.candidates[0].content.parts[0].text;
          responseDiv.textContent = text;
        } else {
          responseDiv.textContent = translations[currentLanguage]["ai-error"];
          console.error("Estructura de respuesta inesperada del LLM:", result);
        }
      } catch (error) {
        responseDiv.textContent = translations[currentLanguage]["ai-error"];
        console.error("Error al llamar a la API de Gemini:", error);
      } finally {
        button.disabled = false;
        loadingIndicator.style.display = 'none';
      }
    }

    // Inicializaci√≥n de la p√°gina al cargar el DOM
    document.addEventListener('DOMContentLoaded', function() {
      // Carga las preferencias de idioma y moneda desde localStorage
      const idiomaGuardado = localStorage.getItem('idiomaPreferido');
      const monedaGuardada = localStorage.getItem('monedaPreferida');

      // Aplica el idioma guardado o 'es' por defecto
      translatePage(idiomaGuardado || 'es');
      // Aplica la moneda guardada o 'ARS' por defecto
      cambiarMoneda(monedaGuardada || 'ARS');

      // Asocia los eventos click a los botones de IA
      document.getElementById('generate-menu-btn').addEventListener('click', () =>
        callGeminiAPI('ai-menu-prompt', 'ai-menu-response', 'generate-menu-btn', 'ai-menu-loading-indicator')
      );
      document.getElementById('generate-accommodation-btn').addEventListener('click', () =>
        callGeminiAPI('ai-accommodation-prompt', 'ai-accommodation-response', 'generate-accommodation-btn', 'ai-accommodation-loading-indicator')
      );
      document.getElementById('generate-family-tips-btn').addEventListener('click', () =>
        callGeminiAPI('ai-family-tips-prompt', 'ai-family-tips-response', 'generate-family-tips-btn', 'ai-family-tips-loading-indicator')
      );
      document.getElementById('generate-budget-btn').addEventListener('click', () =>
        callGeminiAPI('ai-budget-prompt', 'ai-budget-response', 'generate-budget-btn', 'ai-budget-loading-indicator')
      );
    });
  </script>
</body>
</html>
